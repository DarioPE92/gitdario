package actions;

import java.util.List;

import org.junit.Assert;
import org.openqa.selenium.By;
import org.openqa.selenium.NoSuchElementException;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

import pageObjects.formObjects;

public class actionsForm {

	WebDriver driver;
	formObjects objForm = new formObjects(driver);

	public void validateText() throws InterruptedException {
		
		new WebDriverWait(driver, 30).until(ExpectedConditions
				.visibilityOfElementLocated(By.xpath("//*[@id=\"ddmFormAiULf70a\"]/div/div/div[1]/div/div/h4")));

		if (objForm.lblDescricaoForm().getAttribute("innerHTML").toString().equalsIgnoreCase("Let's party rock.")) {

			System.out.println("Text Let's party rock. was Appears");

		} else {

			Assert.fail("Erro! o texto 'Let's party rock.' não está presente no formulário.");
		}

	}

	public void fillInForm(String name, String date, String message) throws InterruptedException {

		objForm.inputNome().sendKeys(name);
		objForm.inputData().click();
		objForm.inputData().sendKeys(date);
		objForm.inputMensagem().sendKeys(message);
		Thread.sleep(1000);
		objForm.butSubmit().click();

	}

	public void validateFields(WebDriver driver) throws InterruptedException {

		List<WebElement> erros = driver.findElements(By.xpath("//*[contains(@class,'form-feedback-item help-block')]"));
		int totalError = erros.size();

		if (totalError > 0) {
			for (int i = 0; i < totalError; i++) {

					Assert.fail("Error - Field not Filled");
			}

		}

	}
	
	public class actionsSentForm {

		public boolean validaEnvioForm(WebDriver driver, int timeout) throws InterruptedException {
			boolean sucesso = false;
			try {
				Thread.sleep(2000);
				WebDriverWait wait = new WebDriverWait(driver, timeout);
				wait.until(ExpectedConditions.elementToBeClickable(objForm.lblFormName()));

				if (objForm.lblFormName().isDisplayed() && objForm.lblMsgConfirmacao().getAttribute("innerHTML")
						.toString().equalsIgnoreCase("Informações enviadas com sucesso!")) {
					sucesso = true;
				} else {

					Assert.fail("Erro no envio do formulário.");
				}

			} catch (NoSuchElementException ex) {
				System.out.println("Formulário não enviado!");

			} finally {
				driver.navigate().back();
			}
			return sucesso;
		}
	}

}
